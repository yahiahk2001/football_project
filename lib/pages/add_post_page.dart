import 'dart:io';
import 'package:flutter/material.dart';
import 'package:supabase_flutter/supabase_flutter.dart';
import 'package:path/path.dart' as path;
import 'package:image_picker/image_picker.dart';

class AddPostPage extends StatefulWidget {
  const AddPostPage({super.key});

  @override
  State<AddPostPage> createState() => _AddPostPageState();
}

class _AddPostPageState extends State<AddPostPage> {
  final _contentController = TextEditingController();
  String _postType = 'Public';
  File? _postImage;
  bool _isLoading = false;
  final _supabase = Supabase.instance.client;

  Future<void> pickImage() async {
    try {
      final ImagePicker picker = ImagePicker();
      final XFile? image = await picker.pickImage(source: ImageSource.gallery);
      if (image != null) {
        setState(() {
          _postImage = File(image.path);
        });
      }
    } catch (e) {
      ScaffoldMessenger.of(context).showSnackBar(
        SnackBar(content: Text('Error picking image: $e')),
      );
    }
  }

  Future<String?> _uploadImage() async {
    if (_postImage == null) return null;
    
    try {
      final fileName = '${DateTime.now().toIso8601String()}_${path.basename(_postImage!.path)}';
      await _supabase.storage.from('posts').upload(fileName, _postImage!);
      return _supabase.storage.from('posts').getPublicUrl(fileName);
    } catch (e) {
      throw Exception('Failed to upload image: $e');
    }
  }

  Future<void> _submitPost() async {
   

    setState(() => _isLoading = true);
    
    try {
      // Get journalist ID from journalists table
      final userId = _supabase.auth.currentUser!.id;
      final journalist = await _supabase
          .from('journalists')
          .select('journalist_id')
          .eq('user_id', userId)
          .single();
      
      final journalistId = journalist['journalist_id'];
      String? imageUrl;
      
      if (_postImage != null) {
        imageUrl = await _uploadImage();
      }

      await _supabase.from('posts').insert({
        'journalist_id': journalistId,
        'content': _contentController.text,
        'image_url': imageUrl,
        'privacy': _postType,
      });

      if (mounted) {
        Navigator.pop(context);
        ScaffoldMessenger.of(context).showSnackBar(
          const SnackBar(content: Text('Post added successfully')),
        );
      }
    } catch (e) {
      if (mounted) {
        ScaffoldMessenger.of(context).showSnackBar(
          SnackBar(content: Text('Error adding post: $e')),
        );
      }
    } finally {
      if (mounted) {
        setState(() => _isLoading = false);
      }
    }
  }

  @override
  void dispose() {
    _contentController.dispose();
    super.dispose();
  }

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(
        elevation: 4,
        centerTitle: true,
        title: const Text(
          'Add Post',
          style: TextStyle(
            fontWeight: FontWeight.bold,
          ),
        ),
        actions: [
          DropdownButton(
          value: _postType,
            items: 
          const [
            DropdownMenuItem(value: 'Public', child: Text('Public')),
            DropdownMenuItem(value: 'Private', child: Text('Private')),
          ], onChanged: (value) {
            setState(() {
              _postType = value.toString();
            });
          })
        ],
      ),
      body: Padding(
        padding: const EdgeInsets.all(12.0),
        child: ListView(
          children: [
            TextField(
              controller: _contentController,
              maxLines: 8,
              decoration: InputDecoration(
                filled: true,
                fillColor: const Color(0xFF95A5A6).withOpacity(0.2),
                hintText: 'Write your post here...',
                hintStyle: const TextStyle(
                  color: Color(0xFF95A5A6),
                ),
                border: OutlineInputBorder(
                  borderRadius: BorderRadius.circular(10),
                  borderSide: BorderSide.none,
                ),
              ),
            ),
            const SizedBox(height: 10),
            if (_postImage != null)
              Padding(
                padding: const EdgeInsets.symmetric(vertical: 8.0),
                child: Image.file(_postImage!),
              ),
            ElevatedButton.icon(
              onPressed: _isLoading ? null : pickImage,
              style: ElevatedButton.styleFrom(
                shape: RoundedRectangleBorder(
                  borderRadius: BorderRadius.circular(10),
                ),
                padding: const EdgeInsets.symmetric(vertical: 16),
              ),
              icon: const Icon(Icons.image, ),
              label: const Text(
                'Add Image',
                style: TextStyle(
                  color: Color(0xFFF5F5F5),
                  fontWeight: FontWeight.bold,
                ),
              ),
            ),
            Padding(
              padding: const EdgeInsets.only(top: 40),
              child: ElevatedButton(
                onPressed: _isLoading ? null : _submitPost,
                style: ElevatedButton.styleFrom(
                  backgroundColor:Colors.redAccent,
                  shape: RoundedRectangleBorder(
                    borderRadius: BorderRadius.circular(10),
                  ),
                  padding: const EdgeInsets.symmetric(vertical: 16),
                ),
                child: _isLoading
                  ? const CircularProgressIndicator(color: Colors.greenAccent)
                  : const Text(
                      'Post',
                      style: TextStyle(
                        fontWeight: FontWeight.bold,
                      ),
                    ),
              ),
            ),
          ],
        ),
      ),
    );
  }
}






//  Future<bool> _isFootballRelated(String content) async {
//   // قائمة بالكلمات المفتاحية الخاصة بكرة القدم
// final List<String> footballKeywords = [
//   // الكلمات الأساسية
//   'كرة القدم', 'كرة القدم', 'كره القدم', 'كره القدم', 'كرة قدم', 'كره قدم',
//   'مباراة', 'مباراه', 'مباريات', 'مبارايات', 'مبارة', 'مباره',
//   'دوري', 'دورى', 'دوريات', 'دوريّات', 'دوريات', 'الدوريات',
//   'كأس', 'كاس', 'كؤوس', 'كئوس', 'كاسات',
//   'هدف', 'هدفين', 'أهداف', 'اهداف', 'هدافين', 'هداف',
//   'لاعب', 'لاعبين', 'لاعبون', 'اللاعب', 'اللاعبين', 'اللاعبون',
//   'حكم', 'حكام', 'حكمين', 'الحكم', 'الحكام', 'تحكيم',
//   'مدرب', 'مدربين', 'مدربون', 'المدرب', 'المدربين', 'المدربون', 'تدريب',
//   'فريق', 'فرق', 'فريقين', 'الفريق', 'الفرق',
//   'نادي', 'نادى', 'أندية', 'انديه', 'انديه', 'اندية', 'النادي',
//   'منتخب', 'منتخبات', 'المنتخب', 'المنتخبات',
  
//   // مصطلحات عامة
//   'الانتقالات', 'انتقالات', 'انتقال', 'الانتقال',
//   'التشكيلة', 'التشكيله', 'تشكيلة', 'تشكيله', 'تشكيل',
//   'الميركاتو', 'ميركاتو', 'سوق الانتقالات',
//   'إصابة', 'اصابة', 'اصابه', 'إصابه', 'إصابات', 'اصابات',
//   'تسلل', 'التسلل', 'تسللات', 'أوفسايد', 'اوفسايد', 'اوفسايدات',
//   'ركلة جزاء', 'ركله جزاء', 'ركلة جزاء', 'ركلات جزاء', 'ركلات الجزاء', 'بنلتي', 'بنالتي',
//   'ضربة جزاء', 'ضربه جزاء', 'ضربات جزاء', 'ضربات الجزاء',
  
//   // الدوريات والمسابقات
//   'الدوري الإنجليزي', 'الدوري الانجليزي', 'الدورى الانجليزى', 'البريميرليغ', 'البريميرليج', 'البريميرليك', 'بريميرليغ',
//   'الدوري الإسباني', 'الدوري الاسباني', 'الدورى الاسبانى', 'الليغا', 'الليجا', 'لاليغا', 'لاليجا',
//   'دوري أبطال أوروبا', 'دوري ابطال اوروبا', 'دورى ابطال اوروبا', 'دوري الأبطال', 'دوري الابطال', 'تشامبيونزليغ', 'تشامبيونز ليغ',
//   'الدوري الإيطالي', 'الدوري الايطالي', 'الدورى الايطالى', 'الكالتشيو', 'كالتشيو', 'السيري آ', 'السيري ا',
//   'الدوري الألماني', 'الدوري الالماني', 'الدورى الالمانى', 'البوندسليغا', 'البوندسليجا', 'بوندسليغا',
//   'الليغ 1', 'الليج 1', 'الدوري الفرنسي', 'الدورى الفرنسى', 'الدوري الفرنسي',
//   'الدوري السعودي', 'الدورى السعودى', 'دوري روشن', 'دورى روشن',
//   'الدوري المصري', 'الدورى المصرى', 'الدوري المصري الممتاز',
//   'الدوري الإماراتي', 'الدوري الاماراتي', 'الدورى الاماراتى',
//   'الدوري القطري', 'الدورى القطرى', 'دوري نجوم قطر',
//   'كأس العالم', 'كاس العالم', 'مونديال', 'المونديال',
//   'كأس أمم أوروبا', 'كاس امم اوروبا', 'يورو', 'اليورو',
//   'كأس أمم أفريقيا', 'كاس امم افريقيا', 'كان', 'الكان',
//   'كأس آسيا', 'كاس اسيا',
//   'كوبا أمريكا', 'كوبا امريكا',
  
//   // الجوائز
//   'الكرة الذهبية', 'الكره الذهبيه', 'بالون دور', 'بالون دور',
//   'الحذاء الذهبي', 'الحذاء الذهبى', 'الحذاء الذهبي',
//   'جائزة الفيفا', 'جائزه الفيفا', 'جوائز الفيفا',
//   'أفضل لاعب', 'افضل لاعب', 'أفضل لاعبين', 'افضل لاعبين',
  
//   // مصطلحات اللعب
//   'ركلة ركنية', 'ركله ركنيه', 'ركلات ركنية', 'ركنية', 'ركنيه', 'كورنر',
//   'ركلة حرة', 'ركله حره', 'ركلات حرة', 'فاول', 'فريكيك',
//   'تسديدة', 'تسديده', 'تسديدات', 'شوت', 'شوط', 'شوطين',
//   'تمريرة', 'تمريره', 'تمريرات', 'باص', 'باصات',
//   'مراوغة', 'مراوغه', 'مراوغات', 'فينتة', 'فينته',
//   'هجمة', 'هجمه', 'هجمات', 'هجوم', 'هجومي', 'هجومى',
//   'دفاع', 'دفاعي', 'دفاعى', 'دفاعية', 'دفاعيه', 'تكتيك',
//   'استراتيجية', 'استراتيجيه', 'استراتيجيات', 'خطة', 'خطه', 'خطط',
//   'مباراة نهائية', 'مباراه نهائيه', 'نهائي', 'نهائى', 'نهائيات',
//   'نصف نهائي', 'نصف نهائى', 'ربع نهائي', 'ربع نهائى',
//   'بطولة', 'بطوله', 'بطولات', 'كأس', 'كاس', 'كؤوس',
//   'مجموعات', 'مجموعه', 'مجموعة', 'تصفيات', 'تصفيه', 'تصفية',
  
//   // مواقع اللعب
//   'حارس مرمى', 'حارس المرمى', 'حارس مرمي', 'حراس مرمى', 'حراسة المرمى', 'حراسه المرمى',
//   'مدافع', 'مدافعين', 'دفاع', 'دفاع', 'مدافعون', 'مدافعون',
//   'ظهير', 'ظهير أيمن', 'ظهير ايمن', 'ظهير أيسر', 'ظهير ايسر',
//   'وسط', 'خط وسط', 'وسط الملعب', 'لاعب وسط', 'لاعبي وسط',
//   'جناح', 'جناح أيمن', 'جناح ايمن', 'جناح أيسر', 'جناح ايسر', 'أجنحة', 'اجنحة', 'اجنحه',
//   'مهاجم', 'مهاجمين', 'مهاجمون', 'هجوم', 'خط هجوم',
//   'رأس حربة', 'راس حربة', 'راس حربه', 'رأس حربه',
  
//   // أحداث المباراة
//   'البطاقة الصفراء', 'البطاقه الصفراء', 'البطاقة الصفراء', 'البطاقه الصفراء', 'كارت أصفر', 'كارت اصفر', 'إنذار', 'انذار',
//   'البطاقة الحمراء', 'البطاقه الحمراء', 'البطاقة الحمراء', 'البطاقه الحمراء', 'كارت أحمر', 'كارت احمر', 'طرد',
//   'تبديل', 'تبديلات', 'استبدال', 'استبدالات',
//   'رمية تماس', 'رميه تماس', 'رميات تماس', 'رمية', 'رميه',
//   'وقت بدل ضائع', 'وقت ضائع', 'وقت اضافي', 'وقت إضافي', 'وقت إضافى',
//   'الشوط الأول', 'الشوط الاول', 'الشوط الأول', 'الشوط الاول',
//   'الشوط الثاني', 'الشوط الثانى', 'الشوط الثاني', 'الشوط الثانى',
//   'الوقت الأصلي', 'الوقت الاصلي', 'الأشواط الإضافية', 'الاشواط الاضافية',
//   'ركلات الترجيح', 'ركلات ترجيح', 'ضربات الجزاء الترجيحية', 'ضربات جزاء ترجيحية',
  
//   // مصطلحات الملعب
//   'ملعب', 'ملاعب', 'استاد', 'استادات', 'ستاد', 'ستادات',
//   'أرضية الملعب', 'ارضية الملعب', 'أرضية', 'ارضية',
//   'منطقة الجزاء', 'منطقه الجزاء', 'منطقة الجزاء', 'منطقه الجزاء',
//   'خط المرمى', 'خط المرمي', 'خط المرمى', 'خط المرمي',
//   'خط التماس', 'خط التماس',
//   'مرمى', 'مرمي', 'المرمى', 'المرمي', 'المرمى', 'المرمي',
//   'راية', 'رايه', 'الراية', 'الرايه', 'رايات', 'الرايات',
//   'عارضة', 'عارضه', 'العارضة', 'العارضه', 'قائم', 'القائم',
  
//   // أسماء اللاعبين والفرق المشهورة
//   'ميسي', 'ميسى', 'ليو ميسي', 'ليو ميسى', 'ليونيل ميسي', 'ليونيل ميسى',
//   'رونالدو', 'كريستيانو رونالدو', 'كريستيانو',
//   'نيمار', 'نيمار جونيور', 
//   'صلاح', 'محمد صلاح', 'مو صلاح',
//   'مبابي', 'مبابى', 'كيليان مبابي', 'كيليان مبابى',
//   'هالاند', 'هالند', 'إيرلينغ هالاند', 'ايرلينغ هالاند',
//   'بنزيما', 'كريم بنزيما',
//   'مودريتش', 'لوكا مودريتش',
//   'ليفاندوفسكي', 'ليفاندوفسكى', 'روبرت ليفاندوفسكي',
//   'برشلونة', 'برشلونه', 'البارسا', 'البرسا',
//   'ريال مدريد', 'ريال', 'الريال', 'الملكي', 'الملكى',
//   'مانشستر يونايتد', 'مان يونايتد', 'المانيو', 'الشياطين الحمر', 'الشياطين الحمر',
//   'ليفربول', 'الريدز', 'الريدز',
//   'مانشستر سيتي', 'مان سيتي', 'السيتي', 'السيتى',
//   'بايرن ميونخ', 'بايرن', 'البايرن', 'البافاري', 'البافارى',
//   'باريس سان جيرمان', 'باريس', 'سان جيرمان', 'بي إس جي', 'بي اس جي',
//   'يوفنتوس', 'اليوفي', 'اليوفى', 'السيدة العجوز',
//   'ميلان', 'إي سي ميلان', 'اي سي ميلان', 'الروسونيري',
//   'إنتر ميلان', 'انتر ميلان', 'الإنتر', 'الانتر', 'النيراتزوري',
//   'تشيلسي', 'تشيلسى', 'البلوز', 'البلوز',
//   'آرسنال', 'ارسنال', 'الغانرز', 'المدفعجية',
//   'أتلتيكو مدريد', 'اتلتيكو مدريد', 'الأتلتي', 'الاتلتي',
//   'توتنهام', 'السبيرز', 'السبيرز',
//   'أياكس', 'اياكس',
//   'بوروسيا دورتموند', 'دورتموند',
//   'الهلال', 'الاتحاد', 'النصر', 'الأهلي', 'الاهلي', 'الزمالك',
  
//   // مصطلحات التكتيك والاستراتيجيات
//   'تكتيك', 'تكتيكات', 'استراتيجية', 'استراتيجيه', 'استراتيجيات',
//   'خطة لعب', 'خطه لعب', 'خطط لعب',
//   'تشكيل', 'تشكيلات', 'تشكيل 4-3-3', 'تشكيل 4-4-2', 'تشكيل 3-5-2',
//   'ضغط عالي', 'ضغط عالى', 'الضغط العالي', 'الضغط العالى',
//   'الاستحواذ', 'استحواذ', 'استحواذ على الكرة',
//   'هجوم مرتد', 'هجوم مرتد', 'الهجمات المرتدة', 'الهجمات المرتده',
//   'دفاع متكتل', 'الدفاع المتكتل', 'دفاع متأخر', 'دفاع متاخر',
//   'تيكي تاكا', 'تيكى تاكا', 'تيكي-تاكا', 'تيكى-تاكا',
//   'بناء من الخلف', 'البناء من الخلف', 'بناء اللعب',
//   'الجناح', 'الأجنحة', 'الاجنحة', 'الاجنحه',
//   'الرواق', 'الأروقة', 'الاروقة', 'الاروقه',
//   'التمريرات القصيرة', 'التمريرات القصيره', 'تمريرات قصيرة', 'تمريرات قصيره',
//   'الكرات العرضية', 'الكرات العرضيه', 'كرات عرضية', 'كرات عرضيه',
//   'الكرات الطويلة', 'الكرات الطويله', 'كرات طويلة', 'كرات طويله',
//   'مصيدة التسلل', 'مصيده التسلل',
//   'التغطية الدفاعية', 'التغطيه الدفاعيه', 'تغطية دفاعية', 'تغطيه دفاعيه',
//   'المراقبة اللصيقة', 'المراقبه اللصيقه', 'مراقبة لصيقة', 'مراقبه لصيقه',
//   'التسلل', 'تسلل', 'أوفسايد', 'اوفسايد',
  
//   // مصطلحات أخرى
//   'بث مباشر', 'بث', 'بث حي', 'بث حى',
//   'تعليق', 'تعليق صوتي', 'تعليق صوتى', 'المعلق', 'معلق',
//   'استديو تحليلي', 'استديو تحليلى', 'تحليل المباراة', 'تحليل المباراه',
//   'محلل', 'محلل فني', 'محلل فنى', 'محللين',
//   'إحصائيات', 'احصائيات', 'إحصاءات', 'احصاءات',
//   'جدول ترتيب', 'جدول الترتيب', 'جدول الدوري', 'جدول الدورى',
//   'هداف', 'هدافين', 'هدافون', 'قائمة الهدافين', 'قائمه الهدافين',
//   'صانع ألعاب', 'صانع العاب', 'صناعة الأهداف', 'صناعه الاهداف',
//   'تمريرة حاسمة', 'تمريره حاسمه', 'تمريرات حاسمة', 'تمريرات حاسمه',
//   'أسيست', 'اسيست', 'أسيستات', 'اسيستات',
//   'الوقت الضائع', 'الوقت الضائع', 'الوقت المحتسب بدل ضائع',
//   'صافرة', 'صافره', 'صفارة', 'صفاره', 'صفارة النهاية', 'صفاره النهايه',
//   'احتفال', 'احتفالات', 'احتفال بالهدف', 'احتفالات بالأهداف',
//   'موسم', 'مواسم', 'موسم كروي', 'موسم كروى',
//   'تعادل', 'تعادلات', 'انتصار', 'انتصارات', 'هزيمة', 'هزيمه', 'هزائم',
//   'كأس السوبر', 'كاس السوبر', 'السوبر', 'السوبر',
//   'الذهاب', 'الإياب', 'الاياب', 'مباراة الذهاب', 'مباراه الذهاب',
//   'مباراة الإياب', 'مباراه الاياب', 'مباراة الإياب', 'مباراه الاياب',
//   'نقل مباشر', 'نقل', 'نقل حي', 'نقل حى',
//   'مشجع', 'مشجعين', 'مشجعون', 'الجمهور', 'جمهور',
//   'المدرجات', 'مدرجات', 'المشجعين', 'المشجعون',
//   'التحكيم', 'حكم المباراة', 'حكم المباراه', 'حكم الساحة', 'حكم الساحه',
//   'الحكم المساعد', 'الحكام المساعدون', 'الحكام المساعدين',
//   'حكم الفيديو', 'حكم الفار', 'تقنية الفيديو', 'تقنيه الفيديو',
//   'الفار', 'VAR', 'تقنية الفار', 'تقنيه الفار',
//   'مراجعة الفيديو', 'مراجعه الفيديو', 'مراجعة الفار', 'مراجعه الفار',
//   'قرار تحكيمي', 'قرار تحكيمى', 'قرارات تحكيمية', 'قرارات تحكيميه',
//   'جدل تحكيمي', 'جدل تحكيمى', 'جدل تحكيمي', 'جدل تحكيمى',
//   'إيقاف', 'ايقاف', 'إيقافات', 'ايقافات', 'موقوف', 'موقوفين',
//   'غرامة', 'غرامه', 'غرامات', 'عقوبة', 'عقوبه', 'عقوبات',
//   'تجديد عقد', 'تجديد العقد', 'تجديد عقود', 'تجديد العقود',
//   'انتهاء عقد', 'انتهاء العقد', 'نهاية العقد', 'نهايه العقد',
//   'التعاقد', 'تعاقد', 'تعاقدات', 'التعاقدات',
//   'رحيل', 'رحيل اللاعب', 'رحيل اللاعبين', 'رحيل المدرب',
//   'تدريب', 'تدريبات', 'التدريب', 'التدريبات',
//   'معسكر', 'معسكرات', 'المعسكر', 'المعسكرات',
//   'إعارة', 'اعارة', 'إعارات', 'اعارات', 'مُعار', 'معار',
//   'شراء', 'صفقة', 'صفقه', 'صفقات', 'صفقه شراء', 'صفقة شراء',
//   'بيع', 'صفقة بيع', 'صفقه بيع', 'صفقات بيع',
//   'البند الجزائي', 'البند الجزائى', 'الشرط الجزائي', 'الشرط الجزائى',
//   'راتب', 'رواتب', 'الراتب', 'الرواتب',
//   'عقد', 'عقود', 'العقد', 'العقود',
//   'مفاوضات', 'المفاوضات', 'التفاوض',
//   'فترة انتقالات', 'فتره انتقالات', 'فترة الانتقالات', 'فتره الانتقالات',
//   'مقاعد البدلاء', 'مقاعد البدلاء', 'دكة البدلاء', 'دكه البدلاء',
//   'البديل', 'البدلاء', 'لاعب بديل', 'لاعبين بدلاء',
//   'راحة', 'راحه', 'الراحة', 'الراحه',
//   'إصابة عضلية', 'اصابة عضليه', 'إصابات عضلية', 'اصابات عضليه',
//   'إصابة قطع', 'اصابة قطع', 'قطع في الرباط', 'قطع فى الرباط',
//   'الرباط الصليبي', 'الرباط الصليبى', 'الرباط الصليبي', 'الرباط الصليبى',
//   'تأهيل', 'تاهيل', 'إعادة تأهيل', 'إعاده تأهيل', 'اعادة تاهيل',
//   'علاج', 'العلاج', 'علاج الإصابة', 'علاج الاصابه',
//   'عملية جراحية', 'عمليه جراحيه', 'عمليات جراحية', 'عمليات جراحيه',
//   'غياب', 'الغياب', 'غاب', 'يغيب', 'سيغيب',
//   'عودة', 'عوده', 'العودة', 'العوده', 'يعود', 'سيعود',
//   'مخالفة', 'مخالفه', 'مخالفات', 'فاول', 'فاولات',
//   'خطأ', 'خطا', 'أخطاء', 'اخطاء',
//   'اعتراض', 'اعتراضات', 'الاعتراض', 'الاعتراضات',
//   'احتجاج', 'احتجاجات', 'الاحتجاج', 'الاحتجاجات',
//   'قميص', 'قمصان', 'القميص', 'القمصان',
//   'طقم', 'أطقم', 'اطقم', 'الطقم', 'الأطقم', 'الاطقم',
//   'رعاية', 'رعايه', 'الرعاية', 'الرعايه',
//   'راعي', 'راعى', 'رعاة', 'الراعي', 'الراعى', 'الرعاة',
//   'جوارب', 'شورت', 'شورتات', 'حذاء', 'أحذية', 'احذيه',
//   'كرة', 'كره', 'الكرة', 'الكره', 'كرات', 'كرة قدم', 'كره قدم',
//   'ملابس', 'ملابس الفريق', 'ملابس اللاعبين',
//   'تذكرة', 'تذكره', 'تذاكر', 'التذكرة', 'التذكره', 'التذاكر',
//   'تلفزيون', 'التلفزيون', 'البث التلفزيوني', 'البث التلفزيونى',
//   'قناة', 'قنوات', 'القناة', 'القنوات',
//   'تطبيق', 'تطبيقات', 'التطبيق', 'التطبيقات',
//   'موقع', 'مواقع', 'الموقع', 'المواقع',
//   'إنترنت', 'الإنترنت', 'الانترنت', 'الشبكة', 'الشبكه',
//   ];

//   // البحث عن أي تطابق مع الكلمات المفتاحية
//   return footballKeywords.any((word) => content.toLowerCase().contains(word.toLowerCase()));
// }

// Future<void> _submitPost() async {
//   setState(() => _isLoading = true);

//   try {
//     final content = _contentController.text.trim();

//     // التحقق مما إذا كان المنشور متعلقًا بكرة القدم
//     if (!(await _isFootballRelated(content))) {
//       ScaffoldMessenger.of(context).showSnackBar(
//         const SnackBar(content: Text('يجب أن يكون المنشور متعلقًا بكرة القدم!')),
//       );
//       setState(() => _isLoading = false);
//       return;
//     }

//     // جلب معرّف الصحفي
//     final userId = _supabase.auth.currentUser!.id;
//     final journalist = await _supabase
//         .from('journalists')
//         .select('journalist_id')
//         .eq('user_id', userId)
//         .single();

//     final journalistId = journalist['journalist_id'];
//     String? imageUrl;

//     if (_postImage != null) {
//       imageUrl = await _uploadImage();
//     }

//     await _supabase.from('posts').insert({
//       'journalist_id': journalistId,
//       'content': content,
//       'image_url': imageUrl,
//       'privacy': _postType,
//     });

//     if (mounted) {
//       Navigator.pop(context);
//       ScaffoldMessenger.of(context).showSnackBar(
//         const SnackBar(content: Text('تمت إضافة المنشور بنجاح!')),
//       );
//     }
//   } catch (e) {
//     if (mounted) {
//       ScaffoldMessenger.of(context).showSnackBar(
//         SnackBar(content: Text('خطأ في إضافة المنشور: $e')),
//       );
//     }
//   } finally {
//     if (mounted) {
//       setState(() => _isLoading = false);
//     }
//   }
// }

